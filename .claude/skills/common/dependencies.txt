# Shared Dependencies Across Office Skills

This file documents dependencies that are shared across multiple Office skills.
See individual skill DEPENDENCIES.md files for complete installation instructions.

## Python Packages

### defusedxml
- **Used by**: docx, pptx
- **Purpose**: Safe XML parsing for OOXML documents
- **Installation**: `pip install defusedxml`
- **License**: PSF

### pandas
- **Used by**: pdf, xlsx
- **Purpose**: Data manipulation for tables and spreadsheets
- **Installation**: `pip install pandas`
- **License**: BSD-3-Clause

## System Packages

### LibreOffice (soffice)
- **Used by**: xlsx, docx, pptx
- **Purpose**: Document calculations and conversions
- **Command**: `soffice`
- **Installation**:
  - macOS: `brew install --cask libreoffice`
  - Ubuntu/Debian: `sudo apt-get install libreoffice`
  - Fedora: `sudo dnf install libreoffice`
  - Windows: Download from https://www.libreoffice.org/
- **License**: MPL 2.0
- **Size**: ~500MB
- **Note**: Optional for most operations, required for formula recalculation (xlsx)

### poppler-utils
- **Used by**: docx, pdf
- **Purpose**: PDF processing and conversion
- **Commands**: pdftotext, pdfimages, pdftoppm, pdfinfo
- **Installation**:
  - macOS: `brew install poppler`
  - Ubuntu/Debian: `sudo apt-get install poppler-utils`
  - Fedora: `sudo dnf install poppler-utils`
  - Windows: `choco install poppler`
- **License**: GPL
- **Note**: Optional for most operations

### Node.js
- **Used by**: docx, pptx
- **Purpose**: JavaScript package runtime for document manipulation
- **Installation**:
  - macOS: `brew install node`
  - Ubuntu/Debian: `sudo apt-get install nodejs npm`
  - Fedora: `sudo dnf install nodejs npm`
  - Windows: Download from https://nodejs.org/
- **License**: MIT
- **Note**: Required for some advanced operations

## Node Packages

### docx
- **Used by**: docx
- **Purpose**: Word document manipulation
- **Installation**: `npm install -g docx`
- **License**: MIT

### pptxgenjs
- **Used by**: pptx
- **Purpose**: PowerPoint generation
- **Installation**: `npm install -g pptxgenjs`
- **License**: MIT

## Installation Order

For users wanting to install all shared dependencies:

1. **System packages first** (may require admin/sudo):
   ```bash
   # macOS
   brew install poppler node
   brew install --cask libreoffice

   # Ubuntu/Debian
   sudo apt-get update
   sudo apt-get install poppler-utils nodejs npm libreoffice

   # Fedora
   sudo dnf install poppler-utils nodejs npm libreoffice
   ```

2. **Python packages**:
   ```bash
   pip install defusedxml pandas
   ```

3. **Node packages** (if Node.js installed):
   ```bash
   npm install -g docx pptxgenjs
   ```

## Dependency Matrix

| Package | pdf | xlsx | docx | pptx | Type | Required |
|---------|-----|------|------|------|------|----------|
| defusedxml | - | - | ✓ | ✓ | Python | Yes |
| pandas | ✓ | ✓ | - | - | Python | Yes |
| LibreOffice | - | ○ | ○ | ○ | System | No |
| poppler-utils | ○ | - | ○ | - | System | No |
| Node.js | - | - | ○ | ○ | System | Partial |
| docx (npm) | - | - | ○ | - | Node | No |
| pptxgenjs (npm) | - | - | - | ○ | Node | No |

Legend:
- ✓ = Required
- ○ = Optional
- - = Not used

## Version Requirements

### Minimum Versions

- Python: 3.8+
- Node.js: 14+ (if using Node packages)
- LibreOffice: 7.0+ (if using)
- poppler-utils: 0.80+ (if using)

### Recommended Versions

- Python: 3.11+
- Node.js: 18+ LTS
- LibreOffice: Latest stable
- poppler-utils: Latest stable

## Platform Notes

### macOS
- Use Homebrew for easiest installation
- LibreOffice available as cask
- All packages well-supported

### Linux (Ubuntu/Debian)
- Use apt for system packages
- All packages available in repositories
- LibreOffice may be pre-installed

### Linux (Fedora/RHEL)
- Use dnf for system packages
- All packages available in repositories
- May need to enable additional repos

### Windows
- Use Chocolatey or manual downloads
- Symlinks may not work (use copies instead)
- LibreOffice and Node.js have GUI installers

## Troubleshooting

### LibreOffice not found
```bash
# Check installation
soffice --version

# If not found, install:
# macOS: brew install --cask libreoffice
# Linux: sudo apt-get install libreoffice
```

### poppler-utils not found
```bash
# Check installation
pdftotext -v

# If not found, install:
# macOS: brew install poppler
# Linux: sudo apt-get install poppler-utils
```

### Node.js not found
```bash
# Check installation
node --version
npm --version

# If not found, install:
# macOS: brew install node
# Linux: sudo apt-get install nodejs npm
```

### Permission issues
```bash
# Use virtual environment for Python packages
python -m venv venv
source venv/bin/activate  # Linux/macOS
venv\Scripts\activate  # Windows

# Or install with --user flag
pip install --user defusedxml pandas
```

## Maintenance

This file should be updated when:
- New shared dependencies are identified
- Version requirements change
- Installation procedures are improved
- Platform-specific notes are discovered

Last updated: 2025-11-08
